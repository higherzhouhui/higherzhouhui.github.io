import{g as ee,a as te}from"../agaentaccount/agaentaccount.a838f357.js";import{u as ae,a as le}from"../vue-router/vue-router.7bf1a7d6.js";import{T as ne}from"../index/index.23d0c00d.js";import{_ as oe,u as re,r as se}from"../../assets/index.a78b18fa.js";import{u as ie}from"../vue-i18n/vue-i18n.d7e01f80.js";import{a as N}from"../element-plus/element-plus.264a2030.js";import{r as ue,a0 as k,a9 as de,l as ce,w,ag as f,aj as me,o as c,c as p,a as C,u as n,W as d,U as g,V as T,X as r,R as i,S as pe,G as ge,F as fe,a6 as Se,Q as Te}from"../@vue/@vue.ac555ff6.js";import"../pinia/pinia.e6361111.js";import"../vue-demi/vue-demi.4f3c4c97.js";import"../js-cookie/js-cookie.431252a9.js";import"../axios/axios.21f17a99.js";import"../path-to-regexp/path-to-regexp.ecb763cd.js";import"../mitt/mitt.fcf4f812.js";import"../lodash-es/lodash-es.b08b606b.js";import"../path-browserify/path-browserify.3d3258d8.js";import"../@vueuse/@vueuse.f48a019e.js";import"../file-saver/file-saver.ff99116b.js";import"../@ctrl/@ctrl.95e2c99f.js";import"../side-channel/side-channel.cd9fb761.js";import"../get-intrinsic/get-intrinsic.5afea291.js";import"../has-symbols/has-symbols.37c383d9.js";import"../function-bind/function-bind.20151ab8.js";import"../has/has.21528ef4.js";import"../call-bind/call-bind.89d60758.js";import"../qs/qs.2a7d7167.js";import"../nprogress/nprogress.f1c59d51.js";/* empty css                                 */import"../clipboard/clipboard.091b7d6b.js";import"../@element-plus/@element-plus.86c1a5c4.js";import"../xe-utils/xe-utils.8594097a.js";import"../vxe-table/vxe-table.93a767e7.js";import"../vite-plugin-mock/vite-plugin-mock.db0c3313.js";import"../mockjs/mockjs.c03cea25.js";import"../@popperjs/@popperjs.f1fb8f77.js";import"../dayjs/dayjs.92e8c432.js";import"../async-validator/async-validator.21881447.js";import"../memoize-one/memoize-one.f0fba034.js";import"../escape-html/escape-html.d572c0fd.js";import"../normalize-wheel-es/normalize-wheel-es.94de1731.js";import"../@floating-ui/@floating-ui.5bbd8ca4.js";import"../@intlify/@intlify.f8bf6d3d.js";const ye={class:"user-list-wrap"},Ue={class:"titles"},Ce={class:"title"},be={key:0},_e={key:0},he={class:"warpperTable"},ve={key:0,class:"normal"},Ae={key:1,class:"frozen"},$e={key:0},Ie={key:1},Ne={key:2},ke={key:3},we={key:4},Ve=["onClick"],De=["onClick"],Re={class:"buts"},Qe={__name:"subordinateAgent",setup(Pe){const b=ae(),_=le(),{t:l}=ie(),V=[{label:l("CUST.translate198"),value:1},{label:l("CUST.translate198"),value:1},{label:l("CUST.translate199"),value:2},{label:l("CUST.translate200"),value:3},{label:l("CUST.translate201"),value:4},{label:l("CUST.translate201"),value:4}],h=re(),A=ue(),e=k({recordList:[],columns:[{prop:"agentId",label:l("CUST.dlID")},{prop:"agentAccount",label:l("CUST.translate209")},{prop:"agentType",label:l("CUST.translate65"),width:"140",slot:"agentType"},{prop:"agentStatus",label:l("CUST.translate130"),slot:"agentStatus"},{prop:"directAgentNum",label:l("CUST.translate213"),slot:"directAgentNum"},{prop:"thisMonthDirectAgentNum",label:l("CUST.translate214")},{prop:"directUserNum",label:l("CUST.translate215"),slot:"directUserNum"},{prop:"thisMonthDirectUserNum",label:l("CUST.translate216")},{prop:"thisMonthDepositUserNum",label:l("AGENT.translate23")},{prop:"thisMonthValidUserNum",label:l("AGENT.translate24")},{prop:"registerTime",label:l("CUST.translate64"),width:180}],total:30,pageSize:10,current:1,timeRange:[],formInline:{agentAccount:"",agentStatus:"",endDate:"",startDate:""},checkDia:!1,checkFormRef:null,checkForm:{agentAccount:"",agentPid:"",commissionRatio:"",loginPwd:"",agentType:3,reloginPwd:""},checkDiaType:"",currentAgaentName:"",loading:!0,routeQueryId:"",routeQueryName:"",downloadLoading:!1}),{checkDia:y,checkForm:m,checkFormRef:Fe}=de(e),D=()=>{e.formInline={agentAccount:"",agentStatus:"",endDate:"",startDate:""},e.timeRange="",e.current=1,U()},R=(t,a,s)=>{if(a==="")s(new Error(l("CUST.translate217")));else if(a){const u=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/;new RegExp(u).test(a)?s():s(new Error(l("CUST.translate86")))}else s()},Q=(t,a,s)=>{a===""?s(new Error(l("CUST.translate88"))):a!==e.checkForm.loginPwd?s(new Error(l("CUST.translate89"))):s()},P=(t,a,s)=>{if(a){const u=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/;new RegExp(u).test(a)?s():s(new Error(l("CUST.translate86")))}else s()},F=(t,a,s)=>{a<0?s(new Error(l("CUST.translate218"))):s()},z=k({commissionRatio:[{required:!0,message:l("CUST.translate206"),trigger:"blur"},{validator:F,trigger:"change"}],agentAccount:[{required:!0,message:l("CUST.translate219"),trigger:["change"]},{validator:P,trigger:"change"}],loginPwd:[{validator:R,trigger:"change"}],reloginPwd:[{validator:Q,trigger:"change"}]});ce(async()=>{e.routeQueryId=b.query.agentId,e.routeQueryName=b.query.agentAcccount,console.log("mouted",b.query.agentId),e.checkForm.agentPid=h.uid,e.currentAgaentName=h.account,e.checkForm.agentType=h.agentType,U()}),w(()=>b.query.agentId,t=>{console.log("watch",t),e.routeQueryId=t,U()}),w(()=>b.query.agentAcccount,t=>{e.routeQueryName=t});const q=t=>{if(t.directAgentNum>0){const a=t.agentId,s=t.agentAccount;_.push({name:"subordinateAgent",query:{agentId:`${e.routeQueryId?`${e.routeQueryId},`:""}${a}`,agentAcccount:`${e.routeQueryName?`${e.routeQueryName}->`:""}${s}`}})}},E=t=>{if(t.directUserNum>0){const a=t.agentId,s=t.agentAccount;_.push({name:"subordinateMember",query:{agentId:`${e.routeQueryId?`${e.routeQueryId},`:""}${a}`,agentAcccount:`${e.routeQueryName?`${e.routeQueryName}->`:""}${s}`}})}},L=()=>{const t=String(e.routeQueryId).split(","),a=String(e.routeQueryName).split("->");t.pop(),a.pop();const s=t.join(","),u=a.join("->");s?_.push({name:"subordinateAgent",query:{agentId:s,agentAcccount:u}}):_.push({name:"subordinateAgent"})},M=()=>{_.push({name:"subordinateAgent"})},U=()=>{let t;e.routeQueryId&&(t=String(e.routeQueryId).split(",").pop()*1,isNaN(t)&&(t=void 0)),e.loading=!0,e.timeRange!==null?(e.formInline.startDate=e.timeRange[0],e.formInline.endDate=e.timeRange[1]):(e.formInline.startDate=null,e.formInline.endDate=null),ee({...e.formInline,pageNum:e.current,pageSize:e.pageSize,agentStatus:e.formInline.agentStatus?e.formInline.agentStatus*1:"",agentPid:t}).then(a=>{e.loading=!1;const s=(a==null?void 0:a.rows)||[];e.recordList=s,e.total=a==null?void 0:a.total})},B=t=>{y.value=!1,t&&t.resetFields()},x=()=>{y.value=!1},G=async t=>{!t||await t.validate((a,s)=>{a?Y():console.log("error submit!",s)})},Y=()=>{e.loading=!0,te({...e.checkForm,agentPid:e.checkForm.agentPid}).then(t=>{e.loading=!1,(t==null?void 0:t.code)===200?(N.success(`${l("CUST.translate148")}\uFF01`),y.value=!1,U()):N.error(t==null?void 0:t.msg)})},Z=async()=>{e.timeRange!==null?(e.formInline.startDate=e.timeRange[0],e.formInline.endDate=e.timeRange[1]):(e.formInline.startDate=null,e.formInline.endDate=null);let t;e.routeQueryId&&(t=String(e.routeQueryId).split(",").pop()*1,isNaN(t)&&(t=void 0)),e.downloadLoading=!0,await se({...e.formInline,agentPid:t},l("CUST.translate185"),"","/user/pageList/export"),e.downloadLoading=!1};function j(t){e.current=t,U()}function H(t){e.pageSize=t,U()}return(t,a)=>{const s=f("el-button"),u=f("el-form-item"),S=f("el-input"),v=f("el-option"),$=f("el-select"),W=f("el-date-picker"),I=f("el-form"),X=f("el-scrollbar"),J=f("el-dialog"),K=me("loading");return c(),p("div",ye,[C("div",Ue,[C("span",Ce,[n(h).account?(c(),p("span",be,d(e.routeQueryName?`${n(h).account}->${e.routeQueryName}`:""),1)):g("",!0),T(" "+d(t.$t("CUST.translate185")),1)]),n(b).query.agentId?(c(),p("span",_e,[C("span",{onClick:M,class:"myAgent"},d(t.$t("AGENT.translate7")),1),C("span",{class:"return",onClick:L},d(t.$t("AGENT.translate8")),1)])):g("",!0)]),r(X,null,{default:i(()=>[r(I,{model:e.formInline,class:"demo-form-inline"},{default:i(()=>[r(u,null,{default:i(()=>[r(s,{onClick:a[0]||(a[0]=o=>y.value=!0),class:"searchButton",icon:"Plus"},{default:i(()=>[T(d(t.$t("CUST.translate186")),1)]),_:1})]),_:1}),r(u,{label:`${n(l)("CUST.translate187")}\uFF1A`,class:"form-items-body"},{default:i(()=>[r(S,{clearable:"",modelValue:e.formInline.agentAccount,"onUpdate:modelValue":a[1]||(a[1]=o=>e.formInline.agentAccount=o),placeholder:n(l)("CUST.translate188"),class:"form-items"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:`${n(l)("CUST.translate130")}:`,class:"form-items-body"},{default:i(()=>[r($,{clearable:"",modelValue:e.formInline.agentStatus,"onUpdate:modelValue":a[2]||(a[2]=o=>e.formInline.agentStatus=o),class:"m-2 form-itemsstatus",placeholder:n(l)("CUST.translate189")},{default:i(()=>[r(v,{value:"",label:n(l)("CUST.translate190")},null,8,["label"]),r(v,{value:2,label:n(l)("CUST.translate191")},null,8,["label"]),r(v,{value:1,label:n(l)("CUST.translate116")},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:`${n(l)("CUST.translate64")}\uFF1A`,class:"form-items-body"},{default:i(()=>[r(W,{modelValue:e.timeRange,"onUpdate:modelValue":a[3]||(a[3]=o=>e.timeRange=o),type:"daterange","range-separator":n(l)("CUST.translate192"),"start-placeholder":n(l)("CUST.translate193"),"end-placeholder":n(l)("CUST.translate194"),style:{"max-width":"250px"},"value-format":"YYYY-MM-DD"},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"])]),_:1},8,["label"]),r(u,null,{default:i(()=>[r(s,{onClick:U,class:"searchButton",icon:"Search",style:{"margin-right":"10px"}},{default:i(()=>[T(d(t.$t("CUST.translate195")),1)]),_:1})]),_:1}),r(u,null,{default:i(()=>[r(s,{onClick:D,class:"resetButton",style:{"margin-right":"10px"}},{default:i(()=>[T(d(t.$t("CUST.translate196")),1)]),_:1})]),_:1}),r(u,null,{default:i(()=>[r(s,{class:"resetButton",loading:e.downloadLoading,type:"success",icon:"Document",onClick:Z},{default:i(()=>[T(d(n(l)("exportReport")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),pe((c(),p("div",he,[r(ne,{data:e.recordList,columns:e.columns,total:e.total,pageSize:e.pageSize,current:e.current,pageUpdate:j,sizeUpdate:H,maxHeight:"calc(100vh - 320px)"},{agentStatus:i(({row:o})=>[o.agentStatus===1?(c(),p("div",ve,d(t.$t("CUST.translate116")),1)):g("",!0),o.agentStatus===2?(c(),p("div",Ae,d(t.$t("CUST.translate191")),1)):g("",!0)]),agentType:i(({row:o})=>[o.agentType===0?(c(),p("div",$e,d(t.$t("CUST.translate197")),1)):g("",!0),o.agentType===1?(c(),p("div",Ie,d(t.$t("CUST.translate198")),1)):g("",!0),o.agentType===2?(c(),p("div",Ne,d(t.$t("CUST.translate199")),1)):g("",!0),o.agentType===3?(c(),p("div",ke,d(t.$t("CUST.translate200")),1)):g("",!0),o.agentType===4?(c(),p("div",we,d(t.$t("CUST.translate201")),1)):g("",!0)]),directAgentNum:i(({row:o})=>[C("div",{onClick:O=>q(o),class:"searchAgentId"},d(o.directAgentNum),9,Ve)]),directUserNum:i(({row:o})=>[C("div",{onClick:O=>E(o),class:"searchAgentId"},d(o.directUserNum),9,De)]),_:1},8,["data","columns","total","pageSize","current"])])),[[K,e.loading]]),r(J,{modelValue:n(y),"onUpdate:modelValue":a[11]||(a[11]=o=>ge(y)?y.value=o:null),"before-close":x,title:n(l)("CUST.translate202"),width:"650px"},{footer:i(()=>[C("div",Re,[r(s,{onClick:a[9]||(a[9]=o=>B(A.value)),class:"buts1"},{default:i(()=>[T(d(t.$t("CUST.translate97")),1)]),_:1}),r(s,{type:"primary",size:"medium",onClick:a[10]||(a[10]=o=>G(A.value)),class:"buts2",loading:e.loading},{default:i(()=>[T(d(t.$t("CUST.translate98")),1)]),_:1},8,["loading"])])]),default:i(()=>[r(I,{model:n(m),ref_key:"ruleFormRef",ref:A,"label-width":"150px",rules:z},{default:i(()=>[r(u,{label:`${n(l)("CUST.translate203")}\uFF1A`},{default:i(()=>[r(S,{value:e.currentAgaentName,placeholder:"",class:"inputs",disabled:""},null,8,["value"])]),_:1},8,["label"]),r(u,{prop:"agentType",label:`${n(l)("CUST.translate65")}\uFF1A`},{default:i(()=>[r($,{modelValue:n(m).agentType,"onUpdate:modelValue":a[4]||(a[4]=o=>n(m).agentType=o),class:"m-2",style:{width:"100%"},size:"large",placeholder:n(l)("CUST.translate204"),clearable:"",disabled:""},{default:i(()=>[(c(),p(fe,null,Se(V,o=>r(v,{label:o.label,value:o.value,key:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(m).agentType===3?(c(),Te(u,{key:0,prop:"commissionRatio",label:`${n(l)("CUST.translate205")}\uFF1A`},{default:i(()=>[r(S,{modelValue:n(m).commissionRatio,"onUpdate:modelValue":a[5]||(a[5]=o=>n(m).commissionRatio=o),placeholder:n(l)("CUST.translate206"),clearable:"",class:"inputs",type:"number","suffix-icon":36},{append:i(()=>[T("%")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):g("",!0),r(u,{prop:"agentAccount",label:`${n(l)("CUST.translate209")}\uFF1A`},{default:i(()=>[r(S,{modelValue:n(m).agentAccount,"onUpdate:modelValue":a[6]||(a[6]=o=>n(m).agentAccount=o),placeholder:n(l)("CUST.translate210"),clearable:"",class:"inputs"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{prop:"loginPwd",label:`${n(l)("CUST.translate211")}\uFF1A`},{default:i(()=>[r(S,{modelValue:n(m).loginPwd,"onUpdate:modelValue":a[7]||(a[7]=o=>n(m).loginPwd=o),placeholder:n(l)("CUST.translate84"),clearable:"",class:"inputs",type:"password","show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{prop:"reloginPwd",label:`${n(l)("CUST.translate87")}\uFF1A`},{default:i(()=>[r(S,{modelValue:n(m).reloginPwd,"onUpdate:modelValue":a[8]||(a[8]=o=>n(m).reloginPwd=o),placeholder:n(l)("CUST.translate212"),clearable:"",class:"inputs",type:"password","show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};var vt=oe(Qe,[["__scopeId","data-v-63255690"]]);export{vt as default};
